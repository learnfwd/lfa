mixin img(path)
  img(src="#{path_to_root + path}")

mixin css(path)
  link(type='text/css', rel='stylesheet', media='screen', href='#{path_to_root + path}')

mixin css-ext(http_path)
  link(type='text/css', rel='stylesheet', media='screen', href='#{http_path}')

mixin js(path)
  script(type='text/javascript', src="#{path_to_root + path}")

mixin js-require(path, require_path)
  script(type='text/javascript', data-main="#{path_to_root + path}", src="#{path_to_root + require_path}")

mixin parallax(path)
  .parallax(style="background-image: url('#{path_to_root + path}')")
    if block
      block

mixin link_to(path)
  a(href="#{path_to_root + path}")
    if block
      block
    else
      = path_to_root + path

mixin toc(chapters)
  ul
    each chapter in chapters
      - function isActive() { return (url == chapter.url) ? "active" : false }
      li(class=isActive())
        +link_to(chapter.url)= chapter.fm.title
        if chapter.children && chapter.children.length
          +toc(chapter.children)

mixin redirect_home()
  - function get_first_page(child) {
  -   if (child.children && child.children.length) {
  -     return get_first_page(child.children[0]);
  -   } else {
  -     return child.url
  -   }
  - }
  - var firstPageUrl = path_to_root + get_first_page(toc[0]);
  script.
    window.location = "#{firstPageUrl}"